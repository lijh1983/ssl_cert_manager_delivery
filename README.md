# SSLè¯ä¹¦ç®¡ç†å™¨

ä¸€ä¸ªä¼ä¸šçº§çš„SSLè¯ä¹¦ç®¡ç†ç³»ç»Ÿï¼Œæä¾›è¯ä¹¦ç”³è¯·ã€ç›‘æ§ã€ç»­æœŸå’Œç®¡ç†çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚å…·å¤‡å››å¤§æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼šæ£€æµ‹å¼€å…³æ§åˆ¶ã€åŸŸåç›‘æ§ã€ç«¯å£ç›‘æ§å’Œè¯ä¹¦æ“ä½œï¼Œä¸ºä¼ä¸šæä¾›ä¸“ä¸šçš„SSLè¯ä¹¦ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“– æ–‡æ¡£å¯¼èˆª

- **[å¿«é€Ÿå¼€å§‹æŒ‡å—](QUICKSTART.md)** - 5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²
- **[æŠ€æœ¯æ¦‚è§ˆ](TECHNICAL_OVERVIEW.md)** - ç³»ç»Ÿæ¶æ„å’ŒæŠ€æœ¯æ ˆ
- **[åŠŸèƒ½ç‰¹æ€§](SSL_CERTIFICATE_FEATURES.md)** - æ ¸å¿ƒåŠŸèƒ½è¯¦è§£
- **[è„šæœ¬ä½¿ç”¨ç¤ºä¾‹](SCRIPT_USAGE_EXAMPLES.md)** - éƒ¨ç½²è„šæœ¬ä½¿ç”¨æŒ‡å—
- **[å¼€å‘è§„åˆ™](DEVELOPMENT_RULES.md)** - å¼€å‘å’Œç»´æŠ¤è§„èŒƒ
- **[ç¯å¢ƒé…ç½®æŒ‡å—](ENV_CONFIG_GUIDE.md)** - ç¯å¢ƒå˜é‡é…ç½®è¯´æ˜
- **[ç¯å¢ƒå®‰å…¨æŒ‡å—](ENVIRONMENT_SECURITY_GUIDE.md)** - ç¯å¢ƒå˜é‡å®‰å…¨ç®¡ç†
- **[æ›´æ–°æ—¥å¿—](update.log)** - ç‰ˆæœ¬æ›´æ–°è®°å½•

### âš¡ ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/lijh1983/ssl_cert_manager_delivery.git
cd ssl_cert_manager_delivery

# ç”Ÿäº§ç¯å¢ƒä¸€é”®éƒ¨ç½²
./scripts/deploy-production.sh
```

**ç³»ç»Ÿè¦æ±‚**: Ubuntu 22.04.5 LTS, 16GBå†…å­˜, 4æ ¸CPU, Docker 26.1.3+

### æ‰‹åŠ¨éƒ¨ç½²

#### 1. é€‰æ‹©é…ç½®æ¨¡æ¿
```bash
# ç‹¬ç«‹éƒ¨ç½²ç¯å¢ƒ (æ¨è)
cp .env.example .env

# æˆ– Dockerç¯å¢ƒ
cp .env.docker.example .env
```

#### 2. ä¿®æ”¹é…ç½®æ–‡ä»¶
```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env

# å¿…é¡»ä¿®æ”¹çš„é…ç½®é¡¹ (åŒ…å«CHANGE_THISçš„é¡¹ç›®)
# - MYSQL_PASSWORD
# - SECRET_KEY
# - JWT_SECRET_KEY
# - REDIS_PASSWORD
# ç­‰ç­‰...

# ç”Ÿæˆå®‰å…¨å¯†é’¥
openssl rand -base64 32  # ç”¨äºSECRET_KEYç­‰
```

#### 3. å¯åŠ¨æœåŠ¡
```bash
# ç‹¬ç«‹éƒ¨ç½²
./scripts/deploy-local.sh

# æˆ– Dockerç¯å¢ƒ
docker-compose up -d
```

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

### æ¨èé…ç½®
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 22.04.5 LTS
- **æ¶æ„**: x86_64
- **Docker**: 26.1.3+
- **Docker Compose**: v2.24.0+
- **å†…å­˜**: 16GB (æœ€ä½8GB)
- **CPU**: 4æ ¸å¿ƒ (æœ€ä½2æ ¸å¿ƒ)
- **ç£ç›˜**: ç³»ç»Ÿç›˜40GB + æ•°æ®ç›˜20GB
- **ç½‘ç»œ**: éœ€è¦è®¿é—®äº’è”ç½‘

## ğŸŒ æœåŠ¡è®¿é—®åœ°å€

éƒ¨ç½²å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®å„é¡¹æœåŠ¡ï¼š

| æœåŠ¡ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| å‰ç«¯é¡µé¢ | http://localhost/ | SSLè¯ä¹¦ç®¡ç†ç•Œé¢ |
| APIæ¥å£ | http://localhost/api/ | REST APIæ¥å£ |
| APIæ–‡æ¡£ | http://localhost/api/docs | Swagger APIæ–‡æ¡£ |

## ğŸ”‘ SSLè¯ä¹¦ç®¡ç†åŠŸèƒ½

### ğŸ¯ å››å¤§æ ¸å¿ƒåŠŸèƒ½æ¨¡å— (100%å®Œæˆ)

#### 1. æ£€æµ‹å¼€å…³æ§åˆ¶ç³»ç»Ÿ
- âœ… **è¯ä¹¦çº§åˆ«ç›‘æ§å¼€å…³** - çµæ´»æ§åˆ¶æ¯ä¸ªè¯ä¹¦çš„ç›‘æ§çŠ¶æ€
- âœ… **ç›‘æ§é¢‘ç‡é…ç½®** - æ”¯æŒæ¯å°æ—¶åˆ°æ¯å‘¨çš„æ£€æŸ¥é¢‘ç‡
- âœ… **æ‰¹é‡ç›‘æ§é…ç½®** - æ‰¹é‡è®¾ç½®å¤šä¸ªè¯ä¹¦çš„ç›‘æ§å‚æ•°
- âœ… **å‘Šè­¦é˜ˆå€¼ç®¡ç†** - è‡ªå®šä¹‰è¯ä¹¦åˆ°æœŸå‘Šè­¦å¤©æ•°

#### 2. åŸŸåç›‘æ§åŠŸèƒ½
- âœ… **DNSè§£ææ£€æŸ¥** - å®æ—¶ç›‘æ§åŸŸåDNSè§£æçŠ¶æ€
- âœ… **åŸŸåå¯è¾¾æ€§ç›‘æ§** - æ£€æµ‹åŸŸåHTTP/HTTPSè®¿é—®çŠ¶æ€
- âœ… **æ™ºèƒ½å‘Šè­¦æœºåˆ¶** - å¤šæ¸ é“å‘Šè­¦ï¼ˆé‚®ä»¶ã€çŸ­ä¿¡ã€Webhookï¼‰
- âœ… **ç›‘æ§å†å²è®°å½•** - å®Œæ•´çš„åŸŸåç›‘æ§å†å²å’Œè¶‹åŠ¿åˆ†æ

#### 3. ç«¯å£ç›‘æ§ç³»ç»Ÿ
- âœ… **SSLç«¯å£æ£€æŸ¥** - ç›‘æ§443ã€8443ç­‰SSLç«¯å£çŠ¶æ€
- âœ… **TLSåè®®æ£€æµ‹** - æ£€æµ‹æ”¯æŒçš„TLSç‰ˆæœ¬å’ŒåŠ å¯†å¥—ä»¶
- âœ… **å®‰å…¨è¯„ä¼°åˆ†æ** - ä¸“ä¸šçš„SSLå®‰å…¨ç­‰çº§è¯„ä¼°(A+åˆ°F)
- âœ… **æ¼æ´æ‰«ææ£€æµ‹** - æ£€æµ‹å·²çŸ¥SSL/TLSå®‰å…¨æ¼æ´

#### 4. è¯ä¹¦æ“ä½œåŠŸèƒ½
- âœ… **æ‰‹åŠ¨æ£€æµ‹è§¦å‘** - æ”¯æŒæ‰‹åŠ¨è§¦å‘å®Œæ•´è¯ä¹¦æ£€æµ‹
- âœ… **æ‰¹é‡å¯¼å…¥å¯¼å‡º** - CSVæ ¼å¼æ‰¹é‡å¯¼å…¥å¯¼å‡ºè¯ä¹¦ä¿¡æ¯
- âœ… **ç½‘ç»œå‘ç°æ‰«æ** - è‡ªåŠ¨å‘ç°ç½‘ç»œä¸­çš„SSLè¯ä¹¦
- âœ… **è¯ä¹¦ç»­æœŸç®¡ç†** - è‡ªåŠ¨å’Œæ‰‹åŠ¨è¯ä¹¦ç»­æœŸåŠŸèƒ½

### ğŸ“Š ä¸“ä¸šç‰¹æ€§
- ğŸ”’ **è¯ä¹¦ç”Ÿå‘½å‘¨æœŸç®¡ç†** - ä»ç”³è¯·åˆ°ç»­æœŸçš„å®Œæ•´æµç¨‹
- ğŸ“ˆ **å®æ—¶ç›‘æ§é¢æ¿** - åŠ¨æ€å›¾è¡¨å’ŒçŠ¶æ€å±•ç¤º
- ğŸ›¡ï¸ **å®‰å…¨åˆè§„æ£€æŸ¥** - åŸºäºæœ€ä½³å®è·µçš„å®‰å…¨å»ºè®®
- ğŸš€ **æ‰¹é‡æ“ä½œæ”¯æŒ** - é«˜æ•ˆçš„æ‰¹é‡å¤„ç†èƒ½åŠ›
- ğŸ“± **å“åº”å¼ç•Œé¢** - æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨ç«¯è®¿é—®

## ğŸ› ï¸ ç®¡ç†å‘½ä»¤

```bash
# ä½¿ç”¨ç»Ÿä¸€ç®¡ç†è„šæœ¬
./scripts/ssl-manager.sh status          # æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./scripts/ssl-manager.sh logs            # æŸ¥çœ‹æœåŠ¡æ—¥å¿—
./scripts/ssl-manager.sh restart         # é‡å¯æœåŠ¡
./scripts/ssl-manager.sh stop            # åœæ­¢æœåŠ¡
./scripts/ssl-manager.sh verify --all    # éªŒè¯ç³»ç»Ÿé…ç½®

# æˆ–ä½¿ç”¨Docker Composeå‘½ä»¤
docker-compose ps                         # æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose logs -f                    # æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose restart backend           # é‡å¯ç‰¹å®šæœåŠ¡
docker-compose down                       # åœæ­¢æ‰€æœ‰æœåŠ¡

# å¤‡ä»½æ•°æ®åº“
docker exec ssl-manager-mysql mysqldump -u ssl_manager -p ssl_manager > backup_$(date +%Y%m%d_%H%M%S).sql
```

## ğŸ“Š åŠŸèƒ½ç‰¹æ€§

- ğŸ”’ **è‡ªåŠ¨SSLè¯ä¹¦ç®¡ç†**: Let's Encryptè¯ä¹¦è‡ªåŠ¨ç”³è¯·å’Œç»­æœŸ
- ğŸŒ **å¤šåŸŸåæ”¯æŒ**: æ”¯æŒå•åŸŸåã€é€šé…ç¬¦å’Œå¤šåŸŸåè¯ä¹¦
- ğŸ“Š **è¯ä¹¦ç›‘æ§**: å†…ç½®SSLè¯ä¹¦çŠ¶æ€ç›‘æ§å’Œåˆ°æœŸæé†’
- ğŸ”„ **è‡ªåŠ¨éƒ¨ç½²**: è¯ä¹¦è‡ªåŠ¨éƒ¨ç½²åˆ°å¤šä¸ªæœåŠ¡å™¨
- ğŸ“± **Webç®¡ç†ç•Œé¢**: ç›´è§‚çš„è¯ä¹¦ç®¡ç†ç•Œé¢
- ğŸ—„ï¸ **MySQL 8.0.41æ•°æ®åº“**: ä¼ä¸šçº§é«˜æ€§èƒ½æ•°æ®å­˜å‚¨
- ğŸš¨ **å‘Šè­¦ç³»ç»Ÿ**: è¯ä¹¦è¿‡æœŸæé†’å’ŒçŠ¶æ€å‘Šè­¦

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æŠ€æœ¯æ ˆ

**åç«¯**:
- Python 3.11+ / Flask
- SQLAlchemy ORM
- MySQL 8.0.41 æ•°æ®åº“ (ä¸“ç”¨)
- Redis 7.2 ç¼“å­˜
- Celery å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—
- Let's Encrypt ACMEåè®®
- JWTè®¤è¯ + CSRFä¿æŠ¤
- PyMySQL æ•°æ®åº“é©±åŠ¨

**å‰ç«¯**:
- Vue.js 3 + TypeScript
- Element Plus UIç»„ä»¶åº“
- Vite 4.4+ æ„å»ºå·¥å…·
- Pinia çŠ¶æ€ç®¡ç†
- Axios HTTPå®¢æˆ·ç«¯
- ECharts æ•°æ®å¯è§†åŒ–
- å“åº”å¼è®¾è®¡ + PWAæ”¯æŒ

**éƒ¨ç½²**:
- Docker + Docker Compose
- Nginx åå‘ä»£ç† + è´Ÿè½½å‡è¡¡
- MySQL 8.0.41 é«˜å¯ç”¨é…ç½®
- æ”¯æŒé˜¿é‡Œäº‘ECSéƒ¨ç½²
- æ”¯æŒæœ¬åœ°åŒ–éƒ¨ç½²
- ä¼ä¸šçº§ç›‘æ§å’Œæ—¥å¿—

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx Proxy   â”‚â”€â”€â”€â”€â”‚    Frontend     â”‚â”€â”€â”€â”€â”‚     Backend     â”‚
â”‚   (Port 80/443) â”‚    â”‚   (Vue.js SPA)  â”‚    â”‚  (FastAPI/Flask)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚              â”‚   MySQL 8.0.41 â”‚    â”‚    Redis 7.2    â”‚
         â”‚              â”‚   (Database)    â”‚    â”‚     (Cache)     â”‚
         â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚

```

## ğŸ“ é¡¹ç›®ç»“æ„

```
ssl_cert_manager_delivery/
â”œâ”€â”€ backend/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ Dockerfile             # åç«¯åº”ç”¨é•œåƒ
â”‚   â”œâ”€â”€ Dockerfile.base        # åç«¯åŸºç¡€é•œåƒ
â”‚   â”œâ”€â”€ requirements.txt       # Pythonä¾èµ–
â”‚   â””â”€â”€ src/                   # æºä»£ç 
â”œâ”€â”€ frontend/                  # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ Dockerfile             # å‰ç«¯åº”ç”¨é•œåƒ
â”‚   â”œâ”€â”€ Dockerfile.base        # å‰ç«¯åŸºç¡€é•œåƒ
â”‚   â”œâ”€â”€ package.json           # Node.jsä¾èµ–
â”‚   â””â”€â”€ src/                   # æºä»£ç 
â”œâ”€â”€ database/                  # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ init/                  # åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ nginx/                     # Nginxé…ç½®
â”œâ”€â”€ monitoring/                # ç›‘æ§é…ç½®
â”œâ”€â”€ scripts/                   # ç®¡ç†è„šæœ¬
â”‚   â””â”€â”€ ssl-manager.sh         # æ ¸å¿ƒç®¡ç†è„šæœ¬
â”œâ”€â”€ tests/                     # æµ‹è¯•ç”¨ä¾‹
â”œâ”€â”€ deploy.sh                  # ä¸€é”®éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ docker-compose.aliyun.yml  # Docker Composeé…ç½®
â”œâ”€â”€ DEPLOYMENT.md              # éƒ¨ç½²æŒ‡å—
â””â”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   ```bash
   # æ£€æŸ¥æ—¥å¿—
   docker-compose -f docker-compose.aliyun.yml logs backend
   
   # æ£€æŸ¥ç«¯å£å ç”¨
   netstat -tlnp | grep :80
   netstat -tlnp | grep :443
   ```

2. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥MySQLçŠ¶æ€
   docker exec ssl-manager-mysql mysqladmin ping -h localhost -u ssl_manager -p

   # é‡å¯æ•°æ®åº“
   docker-compose -f docker-compose.mysql.yml restart mysql
   ```

3. **ç½‘ç»œè¿æ¥é—®é¢˜**
   ```bash
   # æµ‹è¯•ç½‘ç»œè¿æ¥
   docker run --rm alpine:latest wget -O- https://mirrors.aliyun.com
   
   # æ£€æŸ¥DNSé…ç½®
   cat /etc/resolv.conf
   ```

### æ€§èƒ½ä¼˜åŒ–

1. **å†…å­˜ä¼˜åŒ–**
   ```bash
   # æŸ¥çœ‹å†…å­˜ä½¿ç”¨
   docker stats
   
   # è°ƒæ•´workeræ•°é‡ï¼ˆåœ¨.envæ–‡ä»¶ä¸­ï¼‰
   BACKEND_WORKERS=1  # å‡å°‘å†…å­˜ä½¿ç”¨
   ```

2. **ç£ç›˜æ¸…ç†**
   ```bash
   # æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ
   docker image prune -a
   
   # æ¸…ç†æœªä½¿ç”¨çš„å·
   docker volume prune
   ```

## ğŸ“– éƒ¨ç½²è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| DOMAIN_NAME | ä¸»åŸŸå | ssl.gzyggl.com |
| EMAIL | è”ç³»é‚®ç®± | 19822088@qq.com |
| ENVIRONMENT | è¿è¡Œç¯å¢ƒ | production |
| MYSQL_DATABASE | æ•°æ®åº“å | ssl_manager |
| MYSQL_USER | æ•°æ®åº“ç”¨æˆ· | ssl_manager |
| MYSQL_PASSWORD | æ•°æ®åº“å¯†ç  | éšæœºç”Ÿæˆ |

### æ•°æ®æŒä¹…åŒ–

- **MySQLæ•°æ®**: ä¿å­˜åœ¨Dockerå· `mysql_data`
- **SSLè¯ä¹¦**: ä¿å­˜åœ¨Dockerå· `ssl_certs`
- **åº”ç”¨æ—¥å¿—**: ä¿å­˜åœ¨Dockerå· `app_logs`
- **Redisç¼“å­˜**: ä¿å­˜åœ¨Dockerå· `redis_data`

### å®‰å…¨é…ç½®

- ä½¿ç”¨bcryptå“ˆå¸Œå­˜å‚¨å¯†ç 
- MySQLå¤–é”®çº¦æŸç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- è‡ªå¢ä¸»é”®å’Œå”¯ä¸€ç´¢å¼•é¿å…æ•°æ®å†²çª
- å®Œæ•´çš„æ“ä½œå®¡è®¡æ—¥å¿—

## ğŸ¯ ç”Ÿäº§ç¯å¢ƒå»ºè®®

1. **åŸŸåé…ç½®**: ç¡®ä¿åŸŸå `ssl.gzyggl.com` æ­£ç¡®è§£æåˆ°æœåŠ¡å™¨
2. **é˜²ç«å¢™**: å¼€æ”¾80å’Œ443ç«¯å£
3. **SSLè¯ä¹¦**: ç³»ç»Ÿä¼šè‡ªåŠ¨ç”³è¯·å’Œç»­æœŸLet's Encryptè¯ä¹¦
4. **å¤‡ä»½ç­–ç•¥**: å®šæœŸå¤‡ä»½MySQLæ•°æ®åº“å’ŒSSLè¯ä¹¦
5. **ç›‘æ§**: å¯ç”¨Prometheuså’ŒGrafanaç›‘æ§
6. **æ—¥å¿—**: å®šæœŸæ¸…ç†å’Œå½’æ¡£åº”ç”¨æ—¥å¿—

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **GitHub Issues**: https://github.com/lijh1983/ssl_cert_manager_delivery/issues
- **é‚®ç®±**: 19822088@qq.com

## ğŸ“„ è®¸å¯è¯

MIT License
