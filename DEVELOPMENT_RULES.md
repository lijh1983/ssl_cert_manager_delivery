# SSLè¯ä¹¦ç®¡ç†å™¨å¼€å‘å’Œç»´æŠ¤è§„åˆ™

æœ¬æ–‡æ¡£å®šä¹‰äº†SSLè¯ä¹¦ç®¡ç†å™¨é¡¹ç›®çš„å¼€å‘å’Œç»´æŠ¤æ ‡å‡†ï¼Œç¡®ä¿é¡¹ç›®å§‹ç»ˆä¿æŒå¹²å‡€ã€æœ‰åºå’Œä¸“ä¸šçš„çŠ¶æ€ã€‚

## ğŸ“ 1. æ–‡ä»¶ç®¡ç†è§„åˆ™

### 1.1 ä¿ç•™æ–‡ä»¶æ ‡å‡†

#### âœ… å¿…é¡»ä¿ç•™çš„æ–‡ä»¶ç±»å‹
- **æ ¸å¿ƒè„šæœ¬**: `deploy.sh`, `scripts/ssl-manager.sh`, `client/client.sh`
- **ä¸»è¦æ–‡æ¡£**: `README.md`, `DEPLOYMENT.md`, `update.log`
- **é…ç½®æ–‡ä»¶**: `docker-compose.aliyun.yml`, `Dockerfile*`, `.env.example`
- **æºä»£ç **: `backend/src/`, `frontend/src/`
- **æµ‹è¯•æ–‡ä»¶**: `tests/` ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
- **ä¾èµ–é…ç½®**: `requirements.txt`, `package.json`

#### âŒ ç¦æ­¢ä¿ç•™çš„æ–‡ä»¶ç±»å‹
- **ä¸´æ—¶è„šæœ¬**: `fix-*.sh`, `test-*.sh`, `diagnose-*.sh`, `temp_*.sh`
- **æŠ¥å‘Šæ–‡æ¡£**: `*_REPORT.md`, `*_FIX*.md`, `*_VALIDATION*.md`
- **å¤‡ä»½æ–‡ä»¶**: `*.backup`, `*.bak`, `*.old`, `*.tmp`
- **æ„å»ºäº§ç‰©**: `dist/`, `build/`, `node_modules/` (åº”åœ¨.gitignoreä¸­)
- **å¤šç‰ˆæœ¬æ–‡ä»¶**: `README_v2.md`, `docker-compose.yml.new`

### 1.2 å‘½åçº¦å®š

#### ä¸´æ—¶æ–‡ä»¶å‘½åè§„åˆ™
```bash
# å¼€å‘æœŸé—´çš„ä¸´æ—¶æ–‡ä»¶ï¼ˆä»…æœ¬åœ°ä½¿ç”¨ï¼‰
temp_YYYYMMDD_åŠŸèƒ½æè¿°.sh
temp_YYYYMMDD_æ–‡æ¡£ç±»å‹.md

# ç¤ºä¾‹
temp_20250109_database_fix.sh
temp_20250109_deployment_notes.md
```

#### æ°¸ä¹…æ–‡ä»¶å‘½åè§„åˆ™
- **è„šæœ¬æ–‡ä»¶**: kebab-caseï¼Œå¦‚ `ssl-manager.sh`
- **æ–‡æ¡£æ–‡ä»¶**: UPPERCASEï¼Œå¦‚ `README.md`, `DEPLOYMENT.md`
- **é…ç½®æ–‡ä»¶**: ä¿æŒåŸå§‹æ ¼å¼ï¼Œå¦‚ `docker-compose.aliyun.yml`

### 1.3 æ–‡ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†

#### å¼€å‘é˜¶æ®µ
```bash
# å…è®¸ä¸´æ—¶æ–‡ä»¶å­˜åœ¨äºæœ¬åœ°å¼€å‘ç¯å¢ƒ
temp_* æ–‡ä»¶å¯ä»¥å­˜åœ¨ï¼Œä½†ä¸èƒ½æäº¤åˆ°Git

# æäº¤å‰å¿…é¡»æ£€æŸ¥
find . -name "temp_*" -o -name "fix-*" -o -name "*_REPORT.md"
```

#### æäº¤å‰æ¸…ç†
```bash
# è‡ªåŠ¨æ¸…ç†å‘½ä»¤
./scripts/ssl-manager.sh cleanup --dry-run  # é¢„è§ˆ
./scripts/ssl-manager.sh cleanup            # æ‰§è¡Œæ¸…ç†
```

#### å®šæœŸç»´æŠ¤
```bash
# æ¯å‘¨æ‰§è¡Œ
./scripts/ssl-manager.sh cleanup
```

## ğŸ“ 2. æ›´æ–°å’Œç»´æŠ¤å·¥ä½œæµ

### 2.1 ç»Ÿä¸€æ›´æ–°æ—¥å¿— (update.log)

#### æ ‡å‡†æ ¼å¼
```
### [YYYY-MM-DD HH:MM] [ç±»å‹] æ›´æ–°æè¿°
å½±å“èŒƒå›´: å…·ä½“å½±å“çš„ç»„ä»¶æˆ–åŠŸèƒ½
å˜æ›´è¯¦æƒ…: è¯¦ç»†çš„å˜æ›´å†…å®¹
æµ‹è¯•çŠ¶æ€: æµ‹è¯•ç»“æœå’ŒéªŒè¯æƒ…å†µ
---
```

#### æ›´æ–°ç±»å‹åˆ†ç±»
- `[FEATURE]` - æ–°åŠŸèƒ½æ·»åŠ 
- `[BUGFIX]` - é”™è¯¯ä¿®å¤
- `[CLEANUP]` - ä»£ç æ¸…ç†
- `[DOCKER]` - Dockerç›¸å…³æ›´æ”¹
- `[DATABASE]` - æ•°æ®åº“ç›¸å…³æ›´æ”¹
- `[SECURITY]` - å®‰å…¨ç›¸å…³æ›´æ”¹
- `[DOCS]` - æ–‡æ¡£æ›´æ–°

#### æ›´æ–°æ—¥å¿—ç»´æŠ¤
```bash
# ä½¿ç”¨ssl-manager.shæ·»åŠ è®°å½•
./scripts/ssl-manager.sh update-log

# æˆ–æ‰‹åŠ¨æ·»åŠ 
./scripts/ssl-manager.sh update-log \
  --type FEATURE \
  --desc "æ·»åŠ SSLè¯ä¹¦è‡ªåŠ¨ç»­æœŸåŠŸèƒ½" \
  --impact "è¯ä¹¦ç®¡ç†æ¨¡å—" \
  --details "å®ç°äº†åŸºäºcronçš„è‡ªåŠ¨ç»­æœŸæœºåˆ¶" \
  --test "âœ… åŠŸèƒ½æµ‹è¯•é€šè¿‡"
```

### 2.2 æ›´æ–°æ—¥å¿—ç»´æŠ¤è§„åˆ™

#### å¿…é¡»è®°å½•çš„æ›´æ”¹
- æ–°åŠŸèƒ½æ·»åŠ æˆ–é‡è¦åŠŸèƒ½ä¿®æ”¹
- é…ç½®æ–‡ä»¶çš„é‡è¦æ›´æ”¹
- æ•°æ®åº“ç»“æ„å˜æ›´
- å®‰å…¨ç›¸å…³æ›´æ–°
- éƒ¨ç½²æµç¨‹å˜æ›´

#### ä¸éœ€è¦è®°å½•çš„æ›´æ”¹
- å°çš„æ–‡æ¡£ä¿®æ­£
- ä»£ç æ³¨é‡Šæ›´æ–°
- æ ¼å¼åŒ–è°ƒæ•´
- ä¸´æ—¶æ–‡ä»¶æ¸…ç†

## ğŸ”§ 3. è„šæœ¬ç®¡ç†è§„åˆ™

### 3.1 æ ¸å¿ƒè„šæœ¬ç»´æŠ¤

#### ä¸»è¦ç®¡ç†è„šæœ¬
- `scripts/ssl-manager.sh` - å”¯ä¸€çš„æ ¸å¿ƒç®¡ç†è„šæœ¬
- åŒ…å«æ‰€æœ‰ç³»ç»Ÿç®¡ç†åŠŸèƒ½
- ç¦æ­¢åˆ›å»ºæ–°çš„ç‹¬ç«‹ç®¡ç†è„šæœ¬

#### åŠŸèƒ½æ¨¡å—ç»“æ„
```bash
./scripts/ssl-manager.sh <command> [options]

# æ ¸å¿ƒå‘½ä»¤
deploy      # éƒ¨ç½²åŠŸèƒ½
verify      # éªŒè¯åŠŸèƒ½
fix         # ä¿®å¤åŠŸèƒ½
status      # çŠ¶æ€æŸ¥çœ‹
logs        # æ—¥å¿—æŸ¥çœ‹
restart     # é‡å¯æœåŠ¡
stop        # åœæ­¢æœåŠ¡
cleanup     # æ¸…ç†ç³»ç»Ÿ
update-log  # æ›´æ–°æ—¥å¿—
```

### 3.2 è„šæœ¬æ·»åŠ è§„åˆ™

#### âœ… æ­£ç¡®åšæ³•ï¼šé›†æˆåˆ°ssl-manager.sh
```bash
# åœ¨ssl-manager.shä¸­æ·»åŠ æ–°åŠŸèƒ½
case "$command" in
    new-feature)
        new_feature_function "$@"
        ;;
esac
```

#### âŒ é”™è¯¯åšæ³•ï¼šåˆ›å»ºç‹¬ç«‹è„šæœ¬
```bash
# ç¦æ­¢åˆ›å»º
scripts/new-feature.sh
scripts/fix-something.sh
scripts/diagnose-issue.sh
```

#### è„šæœ¬æ–‡æ¡£è¦æ±‚
- æ¯ä¸ªæ–°åŠŸèƒ½å¿…é¡»åœ¨ `show_help()` å‡½æ•°ä¸­æ·»åŠ è¯´æ˜
- å¿…é¡»åŒ…å«ä½¿ç”¨ç¤ºä¾‹
- å¿…é¡»åŒ…å«å‚æ•°è¯´æ˜

### 3.3 å…è®¸çš„è¾…åŠ©è„šæœ¬
- `deploy.sh` - ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼ˆç”¨æˆ·å…¥å£ï¼‰
- `client/client.sh` - å®¢æˆ·ç«¯å®‰è£…è„šæœ¬
- `scripts/cleanup-repo.sh` - ç‹¬ç«‹æ¸…ç†è„šæœ¬ï¼ˆå¯é€‰ï¼‰

## ğŸ“– 4. æ–‡æ¡£ç»´æŠ¤è§„åˆ™

### 4.1 æ ¸å¿ƒæ–‡æ¡£ç®¡ç†

#### ä¸»è¦æ–‡æ¡£æ–‡ä»¶
- `README.md` - é¡¹ç›®æ¦‚è¿°å’Œå¿«é€Ÿå¼€å§‹
- `DEPLOYMENT.md` - è¯¦ç»†éƒ¨ç½²æŒ‡å—
- `update.log` - æ›´æ–°æ—¥å¿—
- `DEVELOPMENT_RULES.md` - å¼€å‘è§„åˆ™ï¼ˆæœ¬æ–‡æ¡£ï¼‰

#### æ–‡æ¡£æ›´æ–°åŸåˆ™
```bash
# âœ… æ­£ç¡®åšæ³•ï¼šç›´æ¥æ›´æ–°ç°æœ‰æ–‡æ¡£
vim README.md
git add README.md
git commit -m "docs: æ›´æ–°READMEéƒ¨ç½²è¯´æ˜"

# âŒ é”™è¯¯åšæ³•ï¼šåˆ›å»ºæ–°ç‰ˆæœ¬æ–‡æ¡£
# ç¦æ­¢ï¼šREADME_v2.md, README_NEW.md, DEPLOYMENT_UPDATED.md
```

### 4.2 æ–‡æ¡£ç‰ˆæœ¬æ§åˆ¶

#### å˜æ›´è¿½è¸ª
- é‡è¦æ–‡æ¡£æ›´æ”¹å¿…é¡»åœ¨ `update.log` ä¸­è®°å½•
- ä½¿ç”¨Gitæäº¤ä¿¡æ¯è¿½è¸ªå°çš„æ–‡æ¡£æ›´æ”¹
- ä¿æŒæ–‡æ¡£ç®€æ´ï¼Œé¿å…å†—ä½™ä¿¡æ¯

#### æ–‡æ¡£è´¨é‡æ ‡å‡†
- æ¸…æ™°çš„ç›®å½•ç»“æ„
- æ ‡å‡†çš„Markdownæ ¼å¼
- å®é™…å¯æ‰§è¡Œçš„å‘½ä»¤ç¤ºä¾‹
- é¿å…è¿‡æ—¶ä¿¡æ¯å’Œæ— æ•ˆé“¾æ¥

### 4.3 æ–‡æ¡£å†…å®¹è§„èŒƒ

#### README.mdç»“æ„
```markdown
# é¡¹ç›®æ ‡é¢˜
## ğŸš€ å¿«é€Ÿéƒ¨ç½²
## ğŸ“‹ ç³»ç»Ÿè¦æ±‚
## ğŸŒ è®¿é—®åœ°å€
## ğŸ”‘ é»˜è®¤è´¦æˆ·
## ğŸ› ï¸ ç®¡ç†å‘½ä»¤
## ğŸ“Š åŠŸèƒ½ç‰¹æ€§
## ğŸ”§ æ•…éšœæ’é™¤
```

#### DEPLOYMENT.mdç»“æ„
```markdown
# éƒ¨ç½²æŒ‡å—
## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡
## ğŸš€ éƒ¨ç½²æ–¹æ³•
## âœ… éƒ¨ç½²éªŒè¯
## ğŸ”§ æœåŠ¡ç®¡ç†
## ğŸ” æ•…éšœæ’é™¤
```

## âš™ï¸ 5. é…ç½®æ–‡ä»¶ç®¡ç†è§„åˆ™

### 5.1 ä¸»è¦é…ç½®æ–‡ä»¶
- `docker-compose.aliyun.yml` - ä¸»è¦éƒ¨ç½²é…ç½®
- `backend/Dockerfile`, `backend/Dockerfile.base`
- `frontend/Dockerfile`, `frontend/Dockerfile.base`
- `.env.example` - ç¯å¢ƒå˜é‡æ¨¡æ¿

### 5.2 é…ç½®æ›´æ–°æµç¨‹
```bash
# 1. å¤‡ä»½å½“å‰é…ç½®ï¼ˆæœ¬åœ°ï¼Œä¸æäº¤ï¼‰
cp docker-compose.aliyun.yml docker-compose.aliyun.yml.backup

# 2. è¿›è¡Œé…ç½®æ›´æ”¹
vim docker-compose.aliyun.yml

# 3. æœ¬åœ°æµ‹è¯•éªŒè¯
docker-compose -f docker-compose.aliyun.yml config

# 4. åŠŸèƒ½æµ‹è¯•
docker-compose -f docker-compose.aliyun.yml up -d
# éªŒè¯æœåŠ¡æ­£å¸¸è¿è¡Œ

# 5. æäº¤æ›´æ”¹
git add docker-compose.aliyun.yml
git commit -m "config: æ›´æ–°Docker Composeé…ç½®"

# 6. è®°å½•åˆ°update.logï¼ˆé‡è¦æ›´æ”¹ï¼‰
./scripts/ssl-manager.sh update-log --type DOCKER --desc "æ›´æ–°Docker Composeé…ç½®"
```

### 5.3 é…ç½®æµ‹è¯•æ¸…å•
```bash
# 1. è¯­æ³•éªŒè¯
docker-compose -f docker-compose.aliyun.yml config

# 2. æ„å»ºæµ‹è¯•
docker-compose -f docker-compose.aliyun.yml build

# 3. å¯åŠ¨æµ‹è¯•
docker-compose -f docker-compose.aliyun.yml up -d

# 4. å¥åº·æ£€æŸ¥
docker-compose -f docker-compose.aliyun.yml ps
curl http://localhost/health

# 5. æ¸…ç†æµ‹è¯•ç¯å¢ƒ
docker-compose -f docker-compose.aliyun.yml down
```

## ğŸ§¹ 6. ä»“åº“å«ç”Ÿè§„åˆ™

### 6.1 è‡ªåŠ¨æ¸…ç†ç¨‹åº

#### ä½¿ç”¨ssl-manager.shæ¸…ç†
```bash
# é¢„è§ˆæ¸…ç†å†…å®¹
./scripts/ssl-manager.sh cleanup --dry-run

# æ‰§è¡Œæ¸…ç†
./scripts/ssl-manager.sh cleanup
```

#### æ¸…ç†å†…å®¹
- ä¸´æ—¶è„šæœ¬ï¼š`temp_*.sh`, `fix-*.sh`, `test-*.sh`, `diagnose-*.sh`
- ä¸´æ—¶æ–‡æ¡£ï¼š`*_REPORT.md`, `*_FIX*.md`, `*_VALIDATION*.md`
- å¤‡ä»½æ–‡ä»¶ï¼š`*.backup`, `*.bak`, `*.old`, `*.tmp`
- ç©ºç›®å½•
- Dockerç³»ç»Ÿæ¸…ç†

### 6.2 æäº¤å‰æ£€æŸ¥æ¸…å•
```bash
# 1. è¿è¡Œä»“åº“æ¸…ç†
./scripts/ssl-manager.sh cleanup

# 2. æ£€æŸ¥æ–‡ä»¶çŠ¶æ€
git status

# 3. éªŒè¯æ²¡æœ‰ä¸´æ—¶æ–‡ä»¶
git ls-files --others --exclude-standard | grep -E "(temp_|fix-|test-|_REPORT)"

# 4. æ›´æ–°update.logï¼ˆå¦‚æœæ˜¯é‡è¦æ›´æ”¹ï¼‰
./scripts/ssl-manager.sh update-log

# 5. æäº¤æ›´æ”¹
git add .
git commit -m "ç±»å‹: ç®€æ´çš„æäº¤æè¿°"
```

### 6.3 æäº¤ä¿¡æ¯è§„èŒƒ
```bash
# æäº¤ç±»å‹å‰ç¼€
feat:     æ–°åŠŸèƒ½
fix:      é”™è¯¯ä¿®å¤
docs:     æ–‡æ¡£æ›´æ–°
style:    ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test:     æµ‹è¯•ç›¸å…³
chore:    æ„å»ºæˆ–è¾…åŠ©å·¥å…·æ›´æ”¹
cleanup:  ä»£ç æ¸…ç†

# ç¤ºä¾‹
git commit -m "feat: æ·»åŠ SSLè¯ä¹¦è‡ªåŠ¨ç»­æœŸåŠŸèƒ½"
git commit -m "fix: ä¿®å¤PostgreSQLè¿æ¥è¶…æ—¶é—®é¢˜"
git commit -m "docs: æ›´æ–°éƒ¨ç½²æŒ‡å—ä¸­çš„ç¯å¢ƒè¦æ±‚"
git commit -m "cleanup: åˆ é™¤ä¸´æ—¶æµ‹è¯•è„šæœ¬"
```

### 6.4 å®šæœŸç»´æŠ¤è®¡åˆ’

#### æ¯æ—¥ç»´æŠ¤ï¼ˆå¼€å‘æœŸé—´ï¼‰
```bash
# æ£€æŸ¥ä¸´æ—¶æ–‡ä»¶
find . -name "temp_*" -o -name "fix-*" -o -name "*_REPORT.md"

# åŠæ—¶æ¸…ç†
./scripts/ssl-manager.sh cleanup
```

#### æ¯å‘¨ç»´æŠ¤
```bash
# 1. å®Œæ•´ä»“åº“æ¸…ç†
./scripts/ssl-manager.sh cleanup

# 2. æ£€æŸ¥update.log
# å¦‚æœè¶…è¿‡100è¡Œï¼Œè€ƒè™‘å½’æ¡£æ—§è®°å½•

# 3. éªŒè¯æ ¸å¿ƒåŠŸèƒ½
./scripts/ssl-manager.sh verify --all

# 4. æ›´æ–°æ–‡æ¡£ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰
```

#### æ¯æœˆç»´æŠ¤
```bash
# 1. ä¾èµ–æ›´æ–°æ£€æŸ¥
# æ£€æŸ¥requirements.txtå’Œpackage.json

# 2. å®‰å…¨æ›´æ–°
# æ£€æŸ¥DockeråŸºç¡€é•œåƒæ›´æ–°

# 3. æ€§èƒ½ä¼˜åŒ–
# æ£€æŸ¥Dockeré•œåƒå¤§å°

# 4. æ–‡æ¡£å®¡æŸ¥
# å…¨é¢å®¡æŸ¥æ–‡æ¡£å‡†ç¡®æ€§
```

## ğŸ¯ 7. æ‰§è¡Œå’Œç›‘ç£

### 7.1 è§„åˆ™æ‰§è¡Œ
- æ‰€æœ‰å¼€å‘äººå‘˜å¿…é¡»éµå®ˆè¿™äº›è§„åˆ™
- ä»£ç å®¡æŸ¥æ—¶æ£€æŸ¥è§„åˆ™éµå®ˆæƒ…å†µ
- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°è§„åˆ™

### 7.2 è¿è§„å¤„ç†
- å‘ç°è¿è§„æ–‡ä»¶æ—¶ç«‹å³æ¸…ç†
- åœ¨ä»£ç å®¡æŸ¥ä¸­æŒ‡å‡ºè¿è§„è¡Œä¸º
- æŒç»­æ•™è‚²å’Œæé†’

### 7.3 è§„åˆ™æ›´æ–°
- æ ¹æ®é¡¹ç›®å‘å±•éœ€è¦æ›´æ–°è§„åˆ™
- é‡è¦è§„åˆ™å˜æ›´éœ€è¦åœ¨update.logä¸­è®°å½•
- ç¡®ä¿æ‰€æœ‰å›¢é˜Ÿæˆå‘˜äº†è§£è§„åˆ™å˜æ›´

## ğŸ“ æ”¯æŒå’Œåé¦ˆ

å¦‚æœå¯¹è¿™äº›è§„åˆ™æœ‰ç–‘é—®æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. åœ¨é¡¹ç›®ä¸­åˆ›å»ºIssueè®¨è®º
2. è”ç³»é¡¹ç›®ç»´æŠ¤è€…
3. åœ¨å›¢é˜Ÿä¼šè®®ä¸­æå‡º

éµå®ˆè¿™äº›è§„åˆ™å°†ç¡®ä¿SSLè¯ä¹¦ç®¡ç†å™¨é¡¹ç›®å§‹ç»ˆä¿æŒä¸“ä¸šã€å¹²å‡€å’Œæ˜“äºç»´æŠ¤çš„çŠ¶æ€ã€‚
